// Simple Emoji Picker
(function() {
    const emojis = {
        'Smileys': ['ğŸ˜€','ğŸ˜ƒ','ğŸ˜„','ğŸ˜','ğŸ˜…','ğŸ˜‚','ğŸ¤£','ğŸ˜Š','ğŸ˜‡','ğŸ™‚','ğŸ™ƒ','ğŸ˜‰','ğŸ˜Œ','ğŸ˜','ğŸ¥°','ğŸ˜˜','ğŸ˜—','ğŸ˜™','ğŸ˜š','ğŸ˜‹','ğŸ˜›','ğŸ˜','ğŸ˜œ','ğŸ¤ª','ğŸ¤¨','ğŸ§','ğŸ¤“','ğŸ˜','ğŸ¤©','ğŸ¥³','ğŸ˜','ğŸ˜’','ğŸ˜','ğŸ˜”','ğŸ˜Ÿ','ğŸ˜•','ğŸ™','â˜¹ï¸','ğŸ˜£','ğŸ˜–','ğŸ˜«','ğŸ˜©','ğŸ¥º','ğŸ˜¢','ğŸ˜­','ğŸ˜¤','ğŸ˜ ','ğŸ˜¡','ğŸ¤¬','ğŸ¤¯','ğŸ˜³','ğŸ¥µ','ğŸ¥¶','ğŸ˜±','ğŸ˜¨','ğŸ˜°','ğŸ˜¥','ğŸ˜“'],
        'Gestures': ['ğŸ‘‹','ğŸ¤š','ğŸ–ï¸','âœ‹','ğŸ––','ğŸ‘Œ','ğŸ¤Œ','ğŸ¤','âœŒï¸','ğŸ¤','ğŸ¤Ÿ','ğŸ¤˜','ğŸ¤™','ğŸ‘ˆ','ğŸ‘‰','ğŸ‘†','ğŸ–•','ğŸ‘‡','â˜ï¸','ğŸ‘','ğŸ‘','âœŠ','ğŸ‘Š','ğŸ¤›','ğŸ¤œ','ğŸ‘','ğŸ™Œ','ğŸ‘','ğŸ¤²','ğŸ¤','ğŸ™'],
        'Hearts': ['â¤ï¸','ğŸ§¡','ğŸ’›','ğŸ’š','ğŸ’™','ğŸ’œ','ğŸ–¤','ğŸ¤','ğŸ¤','ğŸ’”','â£ï¸','ğŸ’•','ğŸ’','ğŸ’“','ğŸ’—','ğŸ’–','ğŸ’˜','ğŸ’'],
        'Objects': ['ğŸ’¬','ğŸ’­','ğŸ—¨ï¸','ğŸ—¯ï¸','ğŸ’¤','ğŸ’¯','ğŸ’¢','ğŸ’¥','ğŸ’«','ğŸ’¦','ğŸ’¨','ğŸ•³ï¸','ğŸ’£','ğŸ’¬','ğŸ“±','ğŸ’»','âŒ¨ï¸','ğŸ–¥ï¸','ğŸ–¨ï¸','ğŸ–±ï¸','ğŸ–²ï¸','ğŸ’¾','ğŸ’¿','ğŸ“€','ğŸ“·','ğŸ“¹','ğŸ¥','ğŸ“','â˜ï¸','ğŸ“Ÿ','ğŸ“ ','ğŸ“º','ğŸ“»']
    };

    window.EmojiPicker = {
        show: function(inputElement) {
            // Remove existing picker
            const existing = document.querySelector('.emoji-picker-popup');
            if (existing) existing.remove();

            const picker = document.createElement('div');
            picker.className = 'emoji-picker-popup';
            picker.style.cssText = 'position:absolute;background:#fff;border:1px solid #ddd;border-radius:8px;padding:10px;box-shadow:0 4px 12px rgba(0,0,0,0.15);z-index:9999;max-width:320px;max-height:300px;overflow-y:auto;';

            let html = '';
            for (const [category, emojiList] of Object.entries(emojis)) {
                html += `<div style="margin-bottom:10px;"><strong style="font-size:11px;color:#666;text-transform:uppercase;">${category}</strong><div style="display:flex;flex-wrap:wrap;gap:4px;margin-top:5px;">`;
                emojiList.forEach(emoji => {
                    html += `<span class="emoji-item" style="cursor:pointer;font-size:20px;padding:4px;border-radius:4px;transition:background 0.2s;" data-emoji="${emoji}">${emoji}</span>`;
                });
                html += '</div></div>';
            }
            picker.innerHTML = html;

            // Position picker
            const rect = inputElement.getBoundingClientRect();
            picker.style.bottom = (window.innerHeight - rect.top + 10) + 'px';
            picker.style.right = (window.innerWidth - rect.right) + 'px';
            
            document.body.appendChild(picker);

            // Add hover effects
            picker.querySelectorAll('.emoji-item').forEach(item => {
                item.addEventListener('mouseenter', e => e.target.style.background = '#f0f0f0');
                item.addEventListener('mouseleave', e => e.target.style.background = 'transparent');
                item.addEventListener('click', e => {
                    inputElement.value += e.target.dataset.emoji;
                    inputElement.focus();
                    picker.remove();
                });
            });

            // Close on outside click
            setTimeout(() => {
                document.addEventListener('click', function closeEmoji(e) {
                    if (!picker.contains(e.target) && e.target !== inputElement) {
                        picker.remove();
                        document.removeEventListener('click', closeEmoji);
                    }
                });
            }, 100);
        }
    };
})();
